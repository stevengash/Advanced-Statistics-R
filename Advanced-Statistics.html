Advanced-Statistics.R
Ngash
2024-02-15
# Load required libraries
library(readxl)
library(ggplot2)
library(moments)
library(car)
library(MASS)
library(qcc)

# Read the data
data <- read_excel("Stat_data.xlsx")

colnames(data)
## [1] "Name"                  "Job Level"            
## [3] "Sector"                "Education"            
## [5] "Discipline"            "Age"                  
## [7] "Salary"                "Customer Satisfaction"
# 1. Identify the type of each parameter (Qualitative & Quantitative).
qualitative_vars <- c("Job Level", "Sector", "Education", "Discipline")
quantitative_vars <- c("Age", "Salary", "Customer Satisfaction")
# 2. Create summary table for Job Level.
summary_job_level <- table(data$`Job Level`)
print(summary_job_level)
## 
##  Junior Manager  Senior 
##      83     295     304
# 3. Draw bar graph for Education.
ggplot(data, aes(x = Education)) +
  geom_bar(fill = "steelblue") +
  labs(title = "Education Distribution",
       x = "Education",
       y = "Frequency")


# 4. Draw pie chart for Sector.
ggplot(data, aes(x = "", fill = Sector)) +
  geom_bar(width = 1) +
  coord_polar("y", start=0) +
  labs(title = "Sector Distribution")


# 5. Draw a histogram for salary.
ggplot(data, aes(x = Salary)) +
  geom_histogram(binwidth = 2000, fill = "skyblue", color = "black") +
  labs(title = "Salary Distribution",
       x = "Salary",
       y = "Frequency")


# Load the psych package
library(psych)

# 6. Calculate descriptive statistics of Salary
salary_stats <- describe(data$Salary)
print(salary_stats)
##    vars   n     mean      sd median  trimmed     mad  min   max range
## X1    1 682 13310.21 7039.15  10471 12349.96 4140.16 4830 30534 25704
##    skew kurtosis     se
## X1 1.06    -0.19 269.54
shapiro.test(data$Salary)
## 
##  Shapiro-Wilk normality test
## 
## data:  data$Salary
## W = 0.83637, p-value < 2.2e-16
# 7. Draw box blot for Age and determine the existence of outliers.
ggplot(data, aes(y = Age)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "Boxplot of Age")


# 8. Draw a Pareto chart for total salary of each Discipline & present your conclusion about the vital few.
#pareto_chart <- qcc(data$Salary, type = "pareto.chart")
# Calculate total salary for each discipline
total_salary_discipline <- aggregate(Salary ~ Discipline, data = data, FUN = sum)
total_salary_discipline <- total_salary_discipline[order(total_salary_discipline$Salary, decreasing = TRUE), ]

# Calculate cumulative percentage
total_salary_discipline$cumulative_percentage <- cumsum(total_salary_discipline$Salary) / sum(total_salary_discipline$Salary) * 100

# Plot Pareto chart
barplot(total_salary_discipline$Salary, names.arg = total_salary_discipline$Discipline, 
        col = "skyblue", main = "Pareto Chart of Total Salary by Discipline",
        ylab = "Total Salary", xlab = "Discipline", las = 2)
par(new = TRUE)
plot(total_salary_discipline$cumulative_percentage, type = "o", col = "red", axes = FALSE, xlab = "", ylab = "", ylim = c(0, 100), lwd = 2)
axis(side = 4)
mtext("Cumulative Percentage", side = 4, line = 3)
legend("topright", legend = c("Total Salary", "Cumulative Percentage"), col = c("skyblue", "red"), lty = c(1, 1), lwd = c(2, 2))


# Question 2
# A. TV Set Factory
mu_tv <- 3500
sigma_tv <- 200

# 1.
pnorm(3350, mean = mu_tv, sd = sigma_tv)
## [1] 0.2266274
# 2.
1 - pnorm(3750, mean = mu_tv, sd = sigma_tv)
## [1] 0.1056498
# 3.
pnorm(3750, mean = mu_tv, sd = sigma_tv) - pnorm(3350, mean = mu_tv, sd = sigma_tv)
## [1] 0.6677229
# 4.
qnorm(0.95, mean = mu_tv, sd = sigma_tv)
## [1] 3828.971
# B. Bank
mu_bank <- 4.78
sigma_bank <- 1.32

# 1.
pnorm(10, mean = mu_bank, sd = sigma_bank)
## [1] 0.9999617
# 2.
1 - pnorm(15, mean = mu_bank, sd = sigma_bank)
## [1] 4.884981e-15
# 3.
pnorm(15, mean = mu_bank, sd = sigma_bank) - pnorm(10, mean = mu_bank, sd = sigma_bank)
## [1] 3.834015e-05
# 4.
qnorm(0.95, mean = mu_bank, sd = sigma_bank)
## [1] 6.951207
# C. Supplier
mu_supplier <- 22.5
sigma_supplier <- 3.2

# 1.
pnorm(20, mean = mu_supplier, sd = sigma_supplier)
## [1] 0.2173277
# 2.
qnorm(0.95, mean = mu_supplier, sd = sigma_supplier)
## [1] 27.76353
# Question 3
# A. Calculate capability indices
# Create a vector with the delivery time data
delivery_time_data <- c(
  29.73, 29.34, 34.07, 27.62, 28.78, 30.84, 32.96, 30.01, 29.03, 27.34,
  26.27, 30.08, 30.09, 35.88, 33.24, 34.04, 32.11, 35.74, 28.52, 25.63,
  36.87, 29.32, 27.71, 27.79, 32.46, 31.60, 28.72, 23.38, 30.23, 28.15,
  30.53, 36.42, 40.31, 27.16, 29.51, 28.66, 36.25, 32.18, 31.43, 33.19,
  31.67, 34.30, 33.59, 28.56, 25.83, 29.98, 35.38, 30.33, 28.17, 26.82,
  28.23, 33.34, 33.32, 34.48, 27.93, 29.26, 28.76, 31.34, 27.61, 33.66,
  26.04, 30.52, 34.20, 31.73
)

# Calculate capability indices
capability_indices <- function(data, lower_spec, upper_spec) {
  cpk <- min((mean(data) - lower_spec) / (3 * sd(data)), (upper_spec - mean(data)) / (3 * sd(data)))
  cpl <- (mean(data) - lower_spec) / (3 * sd(data))
  cpu <- (upper_spec - mean(data)) / (3 * sd(data))
  
  indices <- list(Cpk = cpk, Cpl = cpl, Cpu = cpu)
  return(indices)
}

# Assuming the specification limits for delivery time are 25 and 35 days
lower_spec <- 25
upper_spec <- 35

# Calculate capability indices for Delivery_Time
indices <- capability_indices(delivery_time_data, lower_spec, upper_spec)
print(indices)
## $Cpk
## [1] 0.4327347
## 
## $Cpl
## [1] 0.5863638
## 
## $Cpu
## [1] 0.4327347
# B. Recommendations to improve supplier performance

# Question 4
# Load necessary library for transformations
library(car)

# Define the Cycle Time data
cycle_time_data <- c(
  10.05, 11.16, 7.04, 25.09, 12.56, 17.36, 7.33, 11.35, 9.31, 26.56,
  9.45, 16.31, 19.85, 14.68, 18.47, 22.55, 12.15, 18.42, 16.96, 22.36,
  9.26, 13.94, 8.23, 12.04, 11.26, 10.45, 29.34, 16.06, 25.47, 23.26,
  10.64, 9.90, 14.17, 16.45, 9.74, 32.99, 10.57
)

# A. Transform Cycle Time data using Box-Cox transformation
# Find the lambda parameter for Box-Cox transformation
result <- boxcox(cycle_time_data ~ 1)  # Using ~ 1 to specify no predictor variables


lambda <- result$x[which.max(result$y)]
print(lambda)
## [1] -0.3838384
# Apply Box-Cox transformation
transformed_boxcox <- result$y
print(transformed_boxcox)
##   [1] -39.70411 -39.37133 -39.04596 -38.72805 -38.41766 -38.11485
##   [7] -37.81969 -37.53222 -37.25251 -36.98062 -36.71659 -36.46049
##  [13] -36.21237 -35.97228 -35.74027 -35.51640 -35.30071 -35.09325
##  [19] -34.89407 -34.70323 -34.52075 -34.34670 -34.18110 -34.02401
##  [25] -33.87546 -33.73550 -33.60416 -33.48147 -33.36748 -33.26222
##  [31] -33.16571 -33.07800 -32.99911 -32.92907 -32.86791 -32.81565
##  [37] -32.77232 -32.73794 -32.71253 -32.69611 -32.68870 -32.69031
##  [43] -32.70096 -32.72067 -32.74943 -32.78728 -32.83420 -32.89022
##  [49] -32.95532 -33.02953 -33.11284 -33.20524 -33.30675 -33.41735
##  [55] -33.53704 -33.66581 -33.80366 -33.95058 -34.10655 -34.27157
##  [61] -34.44561 -34.62866 -34.82071 -35.02173 -35.23170 -35.45061
##  [67] -35.67841 -35.91510 -36.16065 -36.41501 -36.67817 -36.95009
##  [73] -37.23075 -37.52009 -37.81810 -38.12472 -38.43993 -38.76368
##  [79] -39.09593 -39.43664 -39.78577 -40.14326 -40.50908 -40.88318
##  [85] -41.26550 -41.65600 -42.05463 -42.46134 -42.87607 -43.29877
##  [91] -43.72939 -44.16787 -44.61415 -45.06819 -45.52991 -45.99928
##  [97] -46.47621 -46.96067 -47.45257 -47.95188
# Question 5

# Load necessary library for reading excel files
library(readxl)

# Read the data from the "Sales Data" sheet
car_factory_data <- read_excel("Stat_data.xlsx", sheet = "Car Factory", skip = 1)

# Extract relevant columns
daily_production <- car_factory_data$`Number of  cars produced`
defective_cars <- car_factory_data$`Number of fixed cars`
car_defects <- car_factory_data$`Number of fixed parts`

# A. Provide comments on the stability of daily production
# Calculate mean and standard deviation of daily production
mean_daily_production <- mean(daily_production)
sd_daily_production <- sd(daily_production)

# Check if daily production is stable based on variability
if (sd_daily_production / mean_daily_production <= 0.1) {
  print("Daily production is stable.")
} else {
  print("Daily production is not stable.")
}
## [1] "Daily production is not stable."
# B. Provide comments on the stability of defective cars
# Calculate mean and standard deviation of defective cars
mean_defective_cars <- mean(defective_cars)
sd_defective_cars <- sd(defective_cars)

# Check if defective cars are stable based on variability
if (sd_defective_cars / mean_defective_cars <= 0.1) {
  print("Defective cars are stable.")
} else {
  print("Defective cars are not stable.")
}
## [1] "Defective cars are not stable."
# C. Provide comments on the stability of car defects
# Calculate mean and standard deviation of car defects
mean_car_defects <- mean(car_defects)
sd_car_defects <- sd(car_defects)

# Check if car defects are stable based on variability
if (sd_car_defects / mean_car_defects <= 0.1) {
  print("Car defects are stable.")
} else {
  print("Car defects are not stable.")
}
## [1] "Car defects are not stable."
# Question 6
# Define the sales data
sales_data <- data.frame(
  Quarter = 1:18,
  Sales = c(45000, 40000, 55000, 85000, 80000, 110000, 125000, 115000, 155000, 160000,
            185000, 175000, 210000, 230000, 255000, 245000, 265000, 275000)
)

# A. Provide comments on the sales trend
# Plot the sales data
plot(sales_data$Quarter, sales_data$Sales, type = "l", xlab = "Quarter", ylab = "Sales", main = "Sales Trend")


# Fit a linear regression model to assess the trend
sales_lm <- lm(Sales ~ Quarter, data = sales_data)
summary(sales_lm)
## 
## Call:
## lm(formula = Sales ~ Quarter, data = sales_data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -19223  -6186   1131   6796  18631 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  17483.7     5157.3    3.39  0.00374 ** 
## Quarter      14592.4      476.5   30.63 1.24e-15 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10490 on 16 degrees of freedom
## Multiple R-squared:  0.9832, Adjusted R-squared:  0.9822 
## F-statistic:   938 on 1 and 16 DF,  p-value: 1.238e-15
# B. Provide comments on the sales seasonality
# Plot seasonal components using decomposition
sales_decomp <- decompose(ts(sales_data$Sales, frequency = 4))
plot(sales_decomp)


# C. Provide comments on the obtained accuracy model
# Calculate residuals
residuals <- residuals(sales_lm)

# Plot residuals
plot(residuals, type = "l", xlab = "Quarter", ylab = "Residuals", main = "Residuals Plot")


# D. Predict the upcoming 3 quarter sales
# Create a data frame for the upcoming quarters
future_quarters <- data.frame(Quarter = 19:21)

# Predict sales for the upcoming quarters using the linear regression model
predicted_sales <- predict(sales_lm, newdata = future_quarters)
print(predicted_sales)
##        1        2        3 
## 294738.6 309330.9 323923.3
